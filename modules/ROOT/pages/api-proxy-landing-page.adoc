= API Proxy
ifndef::env-site,env-github[]
include::_attributes.adoc[]
endif::[]
:keywords: proxy, api, auto-generated, raml, wsdl, apikit, http

API proxies, also known as "autogenerated proxies", are meant to enhance the usability of API Manager in your Mule application.

*Typical usage*: Either when you want to leverage API Gateway capabilities and your backend API is not based on Mule Runtime, or when your API is based on Mule Runtime but you are unable to define the corresponding Autodiscovery element because it is a closed code.

image::api-gateway-capabilities-mule4-62bf9.png[align=center]

When you configure your API to be a Proxy Endpoint, Anypoint Platform allows you to download a preconfigured Mule application. If the application is deployed to a Mule Runtime and you are using the correct Platform Credentials, the API for the application will be automatically tracked by API Manager.

You do not need to know how to create a Mule application. You simply deploy the application to a correctly configured runtime.

[NOTE]
Anypoint Platform can deploy the proxy directly to CloudHub or using the Mule agent, through Runtime Manager.

If you would like to use HTTPS instead of HTTP, you can follow these steps:

. Import the autogenerated proxy into Anypoint Studio.
. Specify the certificates to be used.
. Deploy the application to Cloudhub or a runtime instance.

The proxies that can be downloaded from API Platform are a convenient tool to speed up your Application Network development. +
Having said that, you are not restricted to using an autogenerated proxy. Any Mule application, provided with a correctly configured Autodiscovery, can be used to leverage API Gateway capabilities.

== API Proxy Versioning

API Proxies follow their own versioning. When creating an API proxy, API Manager always uses the latest proxy version available. +
API Proxy version 2.0.0 and later add native support for OAS API specification and are also compatible with RAML 1.0 specifications.

You can specify the version of the proxy you want to use by clicking the *Advanced Options* drop-down menu and selecting the proxy version that best covers your needs.

== API Proxy Validations

With Mule 4, you can perform strict validations directly from API Manager. Strict validations enable the application to compare a request with proxy specifications and allow only those headers and query parameters that are specified in the API definition. 

You can perform strict validations for only query parameters, only headers, or for both. This feature is currently available only for RAML and WSDL proxies in Mule 4.

If you do not enable strict validations, the parameters are still validated against the API definition. However, if the proxy receives a query parameter or a header that is not specified in the definition, that parameter is irrespectively sent to the backend service.

You can  modify validation settings in API Manager when you create a proxy and deploy it using Runtime. You must use a proxy version later than 2.1.0 when modifying or creating a proxy. 


=== API Specifications for Strict Validations

When enabling strict validations for Mule 4 Applications, you must consider its architecture before designing the API specification. If your Mule application implements a proxy or a load balancer in front, the web server might modify the client request to include additional details, such as headers. In such cases, the Mule Application denies the request due to a non-valid header error. 


==== Runtime Fabric headers

The following headers are added by Edge in Runtime Fabric:

`headers:
  x-correlation-id:
    type: string
  x-forwarded-for:
    type: string
  via:
    type: string
  x-forwarded-host:
    type: string`

Therefore, consider adding these headers in the API specification when using Edge.

=== API Proxy Validation and Default Settings

API proxy validations are available for Mule 3 and Mule 4 applications. For Mule 3 runtimes this feature is supported for versions 3.8.x and later. The following table describes the default settings for API proxies based on different Mule versions:

[%header%autowidth.spread]
|===
| API Proxy | Validations Performed | Mule 3x | Mule 4x 
|RAML/REST | Payload (schema), query parameters, URI parameters, headers, and form parameters are validated|Disabled | Enabled 
| WSDL | Envelope is validated against the structure provided in the WSDL file |Disabled | Disabled
|===



== See Also

* xref:proxy-advantages.adoc[Reviewing API Proxy Benefits and Impacts]
* xref:wsdl-raml-http-proxy-reference.adoc[Handling API Proxy status codes]
* xref:https-reference.adoc[Configuring an HTTPS Endpoint]
* xref:proxy-latest-concept.adoc[Deploying an API Proxy]
* xref:proxy-deploy-cloudhub-latest-task.adoc[Deploying an API Proxy to CloudHub]
* xref:proxy-deploy-hybrid-latest-task.adoc[Deploying an API Proxy to Hybrid]
* xref:download-proxy-task.adoc[Downloading an API Proxy]
* xref:proxy-deploy-raml-oas-proxy.adoc[Building a RAML/OAS API Proxy]
* xref:apikit::validate-4-task.adoc[Validating query parameters and headers]
