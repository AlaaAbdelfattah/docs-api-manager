= CORS
ifndef::env-site,env-github[]
include::_attributes.adoc[]
endif::[]
:keywords: cors, api gateway, gateway, policy

[%autowidth.spread,cols="a,a"]
|===
>s| Policy name | cross-origin resource sharing (CORS)
>s| Summary      | Enables access to resources residing in external domains.
>s| Category | Compliance
>s| Available from Mule version | v4.1.1
.4+>.^s| Returned Status Codes |

CORS is a mechanism by which a web application can access resources defined in another domain.  Using CORS, applications invoking JavaScript XMLHttpRequest (XHR) calls from a web page can interact with resources from non-origin domains.

Typically, Web browsers implement this standard for allowing cross origin requests. The CORS policy complies with Cross-Origin Resource Sharing W3C Recommendation from 16 January 2014.

When you apply this policy to your API, it is considered a public resource by default. You can  check will enter the extended CORS configuration. If require that your API be shared with only specific resources, you can configure the policy accordingly.

*<Eva: I saw that you can specify a default group in the UI. What is it? what does it do and what other groups can one create?>*

You must specify the default group before specifying another one. The Default group is not a fallback in the normal sense of a default. In this case, it is only the first group you configure for CORS. -- Eva, not sure about this sentence. What does the fallbacl mean here. Please clarify.

You cannot order the CORS policy. This isn't a technical limitation, but rather by design. No OPTIONS request can reach the backend if CORS is configured, as this request is treated as a Preflight according to the CORS-compliant RFC.

*Eva again the previous sentence does not make sense*

image::cors-policy.png[]



== How This Policy Works

*Eva we don't have much here.*

== Configure the Policy

=== CORS as an Interceptor

In Mule Runtime 4.0, the CORS Interceptor is a element in the HTTP Listener configuration. To be consistent, its configuration is the same as in the policy. Use this feature when the Mule Runtime has not been started with API Gateway capabilities and CORS functionality is needed.

In this scenario, altering the configuration forces an application redeployment.

The CORS configuration structure may change whether it is configured as a public resource or for a selected group of origins. The structure of the latter option is:

----
<http:listener-interceptors>
   <http:cors-interceptor allowCredentials="optional boolean value (true/false)">
       <http:origins> (collection of origins)
           <http:origin url="http://origin.com" accessControlMaxAge="integer value">
               <http:allowed-methods>
                   <http:method methodName="method 1"/>
	    ...
                   <http:method methodName="method n"/>
               </http:allowed-methods>
               <http:allowed-headers>
                   <http:header headerName="header 1"/>
 	    ...
                   <http:header headerName="header n"/>
               </http:allowed-headers>
               <http:expose-headers>
                   <http:header headerName="header 1"/>
	    ...
                   <http:header headerName="header n"/>
               </http:expose-headers>
           </http:origin>
       </http:origins>
   </http:cors-interceptor>
</http:listener-interceptors>
----

The public resource configuration looks like this:

----
<http:listener-interceptors>
   <http:cors-interceptor allowCredentials="optional boolean value (true/false)">
       <http:origins>
           <http:public-resource/>
       </http:origins>
   </http:cors-interceptor>
</http:listener-interceptors>
----

If you cannot implement CORS for your API, another possible solution to an unreachable API is to disable the same-origin restrictions in your browser.

=== Disabling Same-Origin Restrictions in your Browser

Each browser handles these restrictions in a unique way and tips, tricks, and plugins are available on the internet.

Make sure you understand the potential security implications of changing browser security settings. You should only use these options for testing on your own web pages because the browser can become vulnerable to malicious scripts and other potential threats.

=== Google Chrome for Mac OS X

* Open a new Terminal window, paste the following line, and then press *Enter*: `open -a Google\ Chrome --args --disable-web-security`.

=== Google Chrome for Windows

* Open a new Command Prompt window, navigate to the location of the Chrome executable (Chrome.exe), paste the following line, and then press *Enter*: `chrome.exe --disable-web-security`.

=== Internet Explorer

Enable the option to access data sources across domains. In some versions of IE, this option is in Internet Properties > Security tab > Custom Level in Security Level for this Zone > Miscellaneous > Enable Access to Data Sources Across Domains.


== See Also

* xref:cors-policy.adoc[Applying and Editing a CORS Policy]
* https://www.w3.org/TR/cors/[Cross-Origin Resource Sharing W3C Recommendation 16 January 2014]
* https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS#Preflighted_requests[Preflight request]
* https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS#Requests_with_credentials[Mozilla's Request with credentials]
