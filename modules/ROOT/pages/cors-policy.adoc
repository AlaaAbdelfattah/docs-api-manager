= CORS
ifndef::env-site,env-github[]
include::_attributes.adoc[]
endif::[]
:keywords: cors, api gateway, gateway, policy

[%autowidth.spread,cols="a,a"]
|===
>s| Policy name | cross-origin resource sharing (CORS)
>s| Summary      | Enables access to resources residing in external domains.
>s| Category | Compliance
>s| Available from Mule version | v4.1.1
.4+>.^s| Returned Status Codes |

CORS is a mechanism by which a Web application can access resources that are defined in another domain.  Using CORS, applications invoking JavaScript XMLHttpRequest (XHR) calls from a Web page can interact with resources from non-origin domains.

Typically, Web browsers implement this standard for allowing cross origin requests. When you apply this policy to your API, it is considered a public resource by default. You can  check will enter the extended CORS configuration. If require that your API be shared with only specific resources, you can configure the policy accordingly.

The CORS policy complies with CORS W3C recommendation from 16 January 2014.

*<Eva: I saw that you can specify a default group in the UI. What is it? what does it do and what other groups can one create?>*

You must specify the default group before specifying another one. The Default group is not a fallback in the normal sense of a default. In this case, it is only the first group you configure for CORS. -- Eva, not sure about this sentence. What does the fallbacl mean here. Please clarify.

You cannot order the CORS policy. This isn't a technical limitation, but rather by design. No OPTIONS request can reach the backend if CORS is configured, as this request is treated as a Preflight according to the CORS-compliant RFC.



*Eva again the previous sentence does not make sense*

image::cors-policy.png[]

*Eva--do we have any prerequisites or scope and considerations for this policy?*

== How This Policy Works

*Eva we don't have much here.*

== Configuring CORS for non-API Gateway Mule Environments

If your Mule runtime engine (Mule) is not started with API gateway capabilities and you need to implement the CORS functionality, you can use the CORS Interceptor, which is an element in the HTTP Listener configuration and is available in Mule 4.0.

When you modify the configuration, you must redeploy your application. The CORS configuration structure differs based on whether it is configured as a public resource or for a selected group of origins. 

Selected Group Structure Example:

[source, XML,linenums]
----
<http:listener-interceptors>
   <http:cors-interceptor allowCredentials="optional boolean value (true/false)">
       <http:origins> (collection of origins)
           <http:origin url="http://origin.com" accessControlMaxAge="integer value">
               <http:allowed-methods>
                   <http:method methodName="method 1"/>
	    ...
                   <http:method methodName="method n"/>
               </http:allowed-methods>
               <http:allowed-headers>
                   <http:header headerName="header 1"/>
 	    ...
                   <http:header headerName="header n"/>
               </http:allowed-headers>
               <http:expose-headers>
                   <http:header headerName="header 1"/>
	    ...
                   <http:header headerName="header n"/>
               </http:expose-headers>
           </http:origin>
       </http:origins>
   </http:cors-interceptor>
</http:listener-interceptors>
----

Public Resource Example:

[source, XML,linenums]
----
<http:listener-interceptors>
   <http:cors-interceptor allowCredentials="optional boolean value (true/false)">
       <http:origins>
           <http:public-resource/>
       </http:origins>
   </http:cors-interceptor>
</http:listener-interceptors>
----

== Disabling Same-Origin Restrictions in your Browser

If you cannot implement CORS for your API, you can disable the same-origin restrictions in your browser to call an inaccessible API. Each browser handles these restrictions in a unique way. You can research the tips, tricks, and plugins for your browser from the internet.

Before you modify your browser settings, make sure you understand and assess its potential security implications. You must use these browser settings only for testing in your own web pages. Otherwise, the browser can become vulnerable to malicious scripts and other potential threats.

=== Disabling Same-Origin Restrictions on Google Chrome for Mac OS X

To disable same-origin restrictions on Google Chrome for Mac OS X:

* Open a new Terminal window and paste the following line: `open -a Google\ Chrome --args --disable-web-security`.
* Press *Enter*.

=== Disabling Same-Origin Restrictions on Google Chrome for Windows

To disable same-origin restrictions on Google Chrome for Windows:

* Open a command prompt window.
* Navigate to the location of the Chrome executable (Chrome.exe) file.
* Paste the following line: `chrome.exe --disable-web-security`.
* Press *Enter*.

=== Disabling Same-Origin Restrictions on Internet Explorer

To disable same-origin restrictions on Internet Explorer:

* Navigate to *Internet Properties* > *Security* > *Custom Level in Security Level for this Zone* > *Miscellaneous* .
* Enable the Enable Access to Data Sources Across Domains option to access data sources across domains.

== Configuring Policy Parameters

When you apply the policy to your API from the UI, the following parameters are displayed:

%header%autowidth.spread,cols="a,a,a"]
|===
| Element | Description | Required
| Public resource | Whether the CORS configuration is to be applied as a public resource (default). | Yes
| Default Group | This option is displayed when you uncheck the Public resource box. | No
| Support credentials | Eva what are these?| No

|===

== Configuring API Specifications

*Eva-- anything to add here?*


== See Also

* xref:cors-policy.adoc[Applying and Editing a CORS Policy]
* https://www.w3.org/TR/cors/[Cross-Origin Resource Sharing W3C Recommendation 16 January 2014]
* https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS#Preflighted_requests[Preflight request]
* https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS#Requests_with_credentials[Mozilla's Request with credentials]
* xref:release-notes::policies/cors-policy-release-notes.adoc[CORS Policy Release Notes]
